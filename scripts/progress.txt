# Ralph Progress Log
Started: Fri Feb 27 11:08:31 PST 2026
---

## Codebase Patterns
- pytest must be run with `PYTHONPATH=/tmp/pypackages python3.11 -m pytest` (packages bootstrapped from GitHub in prior PRD run; PyPI not accessible)
- pypackages at /tmp/pypackages contains: pytest, pluggy, packaging, iniconfig, pygments (no pytest-asyncio)
- AudioResolver uses dependency injection (`ytdl_class`, `spotipy_client` constructor params) â€” no sys.modules hacking needed in tests
- All resolver tests mock spotipy client via constructor injection, not via sys.modules; lazy-import test uses `patch.dict("sys.modules", {...})`
- `UnsupportedSourceError` is raised for any unrecognised https/http URL that doesn't match YouTube, SoundCloud (or previously Spotify)

---

## 2026-02-27 - US-001
- Removed `spotipy` from `dependencies` in `pyproject.toml`
- Removed `SPOTIFY_CLIENT_ID` and `SPOTIFY_CLIENT_SECRET` entries from `.env.example`
- Created new `scripts/prd.json` for the Remove Spotify Integration PRD (5 stories)
- All 136 existing tests continue to pass (Spotify tests use mock injection so don't require spotipy installed)
- Files changed: pyproject.toml, .env.example, scripts/prd.json, scripts/progress.txt
- **Learnings for future iterations:**
  - The Spotify tests (TestResolveSpotify, TestGetSpotipyClientLazyImport) still pass even without spotipy installed because they use mock injection and `patch.dict("sys.modules", ...)`
  - US-002, US-003, US-004 must be implemented together in one commit: removing Spotify code (US-002) will break TestResolveSpotify (US-004 must follow immediately)
  - US-005 (README/docs cleanup) can be done independently
---
