## Codebase Patterns
- Python project uses pyproject.toml with setuptools; dev deps in `[project.optional-dependencies]` dev extras
- Dashboard is in `dashboard/` with `npm run typecheck` as the TS check command (uses tsc)
- Python linting uses ruff; config in `[tool.ruff]` and `[tool.ruff.lint]` sections of pyproject.toml
- Branch strategy: `develop` for dev/PRs, `main` for production
- Python tools (ruff, pytest) may not be installed in the container; use `python3 -m ruff` or ensure via pip install
- `dashboard/package-lock.json` exists, enabling npm cache in GitHub Actions via `cache-dependency-path: dashboard/package-lock.json`
- `actions/setup-python@v5` supports `cache: "pip"` directly without needing a separate `actions/cache` step
- SSH deploy (appleboy/ssh-action) is the deploy mechanism per the PRD technical considerations

---

## 2026-03-01 - US-002
- What was implemented: Created `.github/workflows/ci.yml` with two parallel jobs:
  - `test-bot`: Python 3.11, pip cache, `pip install -e ".[dev]"`, `pytest --tb=short`, `ruff check bot/`
  - `lint-dashboard`: Node.js 20, npm cache, `npm ci`, `npm run typecheck` (working dir: `dashboard/`)
  - Workflow triggers on `pull_request` targeting `develop`
- Files changed: `.github/workflows/ci.yml`, `prd.json`, `progress.txt`
- **Learnings for future iterations:**
  - Python tools (ruff, pytest) are not installed in the container environment; quality checks for Python must rely on GitHub Actions CI or install via the local Python 3.11 that is present
  - `dashboard/` has `npm run typecheck` script (`tsc -b --noEmit`) which passed cleanly
  - `package-lock.json` exists in `dashboard/` enabling npm dependency caching
  - `actions/setup-python@v5` `cache: "pip"` option handles pip caching without extra steps
  - For deploy workflows (US-003, US-004) use `appleboy/ssh-action` per PRD technical notes
---

## 2026-03-01 - US-003
- What was implemented: Created `.github/workflows/deploy-dev.yml` with CI checks + SSH deploy to development environment
  - Reuses same `test-bot` (Python 3.11) and `lint-dashboard` (Node.js 20) jobs from ci.yml
  - `deploy` job runs after both CI jobs pass (`needs: [test-bot, lint-dashboard]`)
  - Uses `environment: development` GitHub Environment
  - SSH deploy via `appleboy/ssh-action@v1` using `DEV_HOST`, `DEV_USER`, `DEV_SSH_KEY`, `DEV_DEPLOY_PATH` secrets
  - Deploy script: `docker compose pull && docker compose up -d --build`
  - Triggers on `push` to `develop`
- Files changed: `.github/workflows/deploy-dev.yml`, `prd.json`, `progress.txt`
- **Learnings for future iterations:**
  - Deploy jobs should use `needs: [test-bot, lint-dashboard]` to enforce CI before deploy
  - `appleboy/ssh-action@v1` is the SSH deploy action; secrets pattern: `DEV_*` for dev, `PROD_*` for prod
  - `environment: development` / `environment: production` references GitHub Environments for secrets scoping and deployment tracking
---

## 2026-03-01 - US-004
- What was implemented: Created `.github/workflows/deploy-prod.yml` for production CD on push to main
  - Reuses same `test-bot` (Python 3.11) and `lint-dashboard` (Node.js 20) CI jobs
  - `deploy` job runs after both CI jobs pass (`needs: [test-bot, lint-dashboard]`)
  - Uses `environment: production` GitHub Environment
  - SSH deploy via `appleboy/ssh-action@v1` using `PROD_HOST`, `PROD_USER`, `PROD_SSH_KEY`, `PROD_DEPLOY_PATH` secrets
  - Deploy script: `docker compose pull && docker compose up -d --build`
  - Triggers on `push` to `main`
- Files changed: `.github/workflows/deploy-prod.yml`, `prd.json`, `progress.txt`
- **Learnings for future iterations:**
  - Production workflow mirrors dev workflow exactly; only differences: trigger branch (`main` vs `develop`), environment name (`production` vs `development`), secrets prefix (`PROD_*` vs `DEV_*`)
  - Both CI jobs must be included in the deploy workflow since GitHub Actions doesn't support cross-workflow job dependencies natively
---
